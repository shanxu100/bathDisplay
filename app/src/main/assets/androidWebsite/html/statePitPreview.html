<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><!--<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">--><title>厕所状态预览</title><link rel=stylesheet href=../resource/frame/layui/layui.css><script src=../resource/frame/jquery/jquery-3.2.1.min.js></script><script src=../resource/frame/layui/layui.js></script><style>.pitSection{height:95vh;width:51vw;background:url(../resource/images/pit/bg.png) no-repeat;background-size:51vw 95vh}.pitDiv{font-family:"楷体",serif;color:#fff;max-height:86vh;width:44.4vw;margin-left:5.6vw;margin-top:5vh;display:flex;justify-content:flex-start;align-items:flex-end;align-content:flex-start;flex-wrap:wrap;overflow-y:scroll;-ms-overflow-style:none;overflow:-moz-scrollbars-none}.pitDiv::-webkit-scrollbar{width:0!important}.pitDiv div:first-child{width:13.6vw;margin-left:3.3vw;height:max-content;text-align:left}.pitDiv div:first-child img{width:6.6vw}.pitItemDiv{margin:.5vw .5vw 0;text-align:center}.pitItemDiv img{width:4.6vw}.pitItemDiv p{line-height:1.6vw;font-size:1.6vw}</style><script>"use strict";var deviceGroupMap={1:0,2:1,3:2};setInterval(function(){!window.isShowMsg&&0<msgQueue.length&&(window.isShowMsg=!0,window.layer.msg(window.msgQueue.shift(),{time:2600,shade:.1,anim:0,scrollbar:!1},function(){window.isShowMsg=!1}))},500),layui.use(["layer"],function(){var i=layui.layer;window.msgQueue=[],window.isShowMsg=!1,window.layer=i,window.alert=function(i){"[object Object]"===Object.prototype.toString.call(i)&&(i=JSON.stringify(i,null,2)),window.msgQueue.push(i)}})</script></head><body style=margin:0;background:url(../resource/images/pit/background.jpg)><!--<body style="background: rgba(0,0,0,0);margin: 0;padding: 0">--><!--厕所状态--><div style=width:100vw;height:100vh;display:flex;justify-content:center;align-items:center><!--男厕--><section class=pitSection><div class=pitDiv><div><img src=../resource/images/pit/state_man.png></div></div></section><!--女厕--><section class=pitSection style=margin-left:-2vw><div class=pitDiv><div><img src=../resource/images/pit/state_woman.png></div></div></section></div><script>"use strict";var USAGE_NAME=["man","woman","disabled"],PIT_IMG_ARR=[["../resource/images/pit/dun_nouse.png","../resource/images/pit/dun_use.png","../resource/images/pit/dun_abnormal.png"],["../resource/images/pit/man_nouse.png","../resource/images/pit/man_use.png","../resource/images/pit/man_abnormal.png"],["../resource/images/pit/sit_nouse.png","../resource/images/pit/sit_use.png","../resource/images/pit/sit_abnormal.png"]],pitImgSrc={man:[],woman:[],disabled:[]};function setOnePit(e){var i=deviceGroupMap[parseInt(e.deviceGroup)];if(null!=i)if(e.deviceGroup=i,e.available=e.available?0:1,e.deviceNum=e.deviceNum-1,2!==i)if(0<=e.deviceNum){var a=$($(".pitDiv")[e.deviceGroup]).find(".pitItemDiv img")[e.deviceNum],r=pitImgSrc[USAGE_NAME[e.deviceGroup]][e.deviceNum];r[1]=e.available,a.src=PIT_IMG_ARR[r[0]][r[1]]}else alert("无效的deviceNum："+(e.deviceNum+1));else pitImgSrc.disabled[e.deviceNum][1]=e.available;else alert("无效的deviceGroup:"+e.deviceGroup)}</script><script>"use strict";var hasFreshPitNum=!1,toiletPitNum={};function freshPitNum(r){hasFreshPitNum=!0,r=r.startsWith("{")?JSON.parse(r):r,toiletPitNum=r,pitImgSrc.man.length=0,pitImgSrc.woman.length=0,pitImgSrc.disabled.length=0,$(".pitDiv").map(function(i,e){$(e).find("div:gt(0)").remove()}),USAGE_NAME.forEach(function(n,i){var e=n[0].toUpperCase()+n.substring(1),t=[parseInt(r["num"+e+"Sit"]),parseInt(r["num"+e+"Stand"])];if(console.debug(t),t[0]=t[0]?t[0]:0,t[1]=t[1]?t[1]:0,1<i)for(var u=0;u<t[0]+t[1];u++)pitImgSrc.disabled.push([1,0]);else{var a="";t.reduce(function(i,e,t){return a+=function(i,e,t,n){for(var u="",a=1;a<=e;a++)u+='<div class="pitItemDiv"><img src="'+PIT_IMG_ARR[t][0]+'"><p>'+(i+a)+"</p></div>",pitImgSrc[n].push([t,0]);return u}(i,e,t,n),i+e},0),$($(".pitDiv")[i]).append(a)}})}function androidCallFunction(i){var e=i.startsWith("{")?JSON.parse(i):i;e=handleDeviceNum(e),setOnePit(e);var t=[0,0,0];USAGE_NAME.forEach(function(i,e){pitImgSrc[i].forEach(function(i){0===i[1]&&t[e]++})});var n={manAvailableCount:t[0],womanAvailableCount:t[1],disabledAvailableCount:t[2]};return JSON.stringify(n)}function handleDeviceNum(i){return 1==i.deviceGroup?60<i.deviceNum&&(i.deviceNum=i.deviceNum-60+toiletPitNum.numManSit):2==i.deviceGroup?i.deviceNum=i.deviceNum-90:3==i.deviceGroup&&(i.deviceNum-=150,10<i.deviceNum&&(i.deviceNum=i.deviceNum-10+toiletPitNum.numDisabledSit)),console.debug(pitImgSrc),i}$(function(){hasFreshPitNum||freshPitNum(JSON.stringify({numManStand:10,numManSit:36,numWomanSit:36,numDisabledSit:6,numDisabledStand:6}));androidCallFunction(JSON.stringify({deviceGroup:1,deviceNum:61,available:!1}))})</script></body></html>